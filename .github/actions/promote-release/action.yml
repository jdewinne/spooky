name: 'Replicated promote Release'
description: 'Promote a Release to a Channel'
inputs:
  replicated-app:
    description: 'Replicated App Slug.'
    required: true
    default: ''
  replicated-api-token:
    description: 'Replicated API Token.'
    required: true
    default: ''
  channel-from:
    description: 'The name of the Channel to get the release sequence from.'
    required: true
  channel-to:
    description: 'The name of the Channel to promote the release sequence to.'
    required: true
  release-version:
    description: 'The version field of the Release to promote.'
    required: true
runs:
  using: "composite"
  steps:
  - name: 'Inspect from channel'
    id: 'inspect-from-channel'
    uses: replicatedhq/reliability-actions-lib/inspect-channel@v0.0.1-alpha.6
    with:
      replicated-app: ${{ inputs.replicated-app }}
      replicated-api-token: ${{ inputs.replicated-api-token }}
      channel-name: ${{ inputs.channel-from }}
  - name: 'Inspect to channel'
    id: 'inspect-to-channel'
    uses: replicatedhq/reliability-actions-lib/inspect-channel@v0.0.1-alpha.6
    with:
      replicated-app: ${{ inputs.replicated-app }}
      replicated-api-token: ${{ inputs.replicated-api-token }}
      channel-name: ${{ inputs.channel-to }}
  - name: 'Replicated CLI promote Release'
    id: 'cli-promote-release'
    uses: jdewinne/gh-actions/cli-promote-release@v0.0.3
    with:
      replicated-app: ${{ inputs.replicated-app }}
      replicated-api-token: ${{ inputs.replicated-api-token }}
      release-sequence: ${{ steps.inspect-from-channel.outputs.release-sequence }}
      channel-id: ${{ steps.inspect-to-channel.outputs.channel-id }}
      version: ${{ inputs.release-version }}